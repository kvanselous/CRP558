<!<!DOCTYPE html>
  <html>
    <head>
      <!--Data References-->
      <!--National substance induced mortality rate gejson created by joining 2013-2018 drug/alcohol induced causes of death and United States Tiger/Line Shapefiles from data.gov in QGIS.  Link for CDC: https://wonder.cdc.gov/.  Link for data.gov: https://catalog.data.gov/dataset/tiger-line-shapefile-2017-nation-u-s-current-state-and-equivalent-national--> 
      <!--Iowa substance induced mortality gejson created by joining the number 1999-2018 drug/alcohol induced death and IowaGEOData Shapefiles in QGIS.  Link for CDC: https://wonder.cdc.gov/.  Link for data.gov: https://geodata.iowa.gov/dataset/county-boundaries-iowa--> 
      <!--Iowa poverty geoJSON created by joining the Census Bureaus’ 5 year estimates of percent living below poverty in past 12 months and IowaGEOData Shapefiles in QGIS: Link for Census Bureau: https://data.census.gov/cedsci/table?g=0400000US19.050000&tid=ACSST5Y2018.S1701&t=Income%20and%20Poverty&vintage=2018&hidePreview=true&layer=VT_2018_050_00_PY_D1&cid=S1701_C01_001E.  Link for data.gov: https://geodata.iowa.gov/dataset/county-boundaries-iowa-->      <!--Need to add provider data, COVID data, Iowa data etc-->
      <!--Iowa COVID-19 data added as REST layer from Esri from: https://services.arcgis.com/vPD5PVLI6sfkZ5E4/ArcGIS/rest/services/IA_COVID19_Cases/FeatureServer-->
      <!--Iowa Substance Use Provider List added from Advancing Substance Use Recovery Project.  Please see report for more information regarding this dataset.  
        
      <!--Resources to build this page-->
      <!--Course materials from CRP 558.-->
      <!--Example of project final posted to CRP 558: https://rahasan17.github.io/LA458-558/FinalProject/index.html-->
      <!--Leaflet materials from: https://leafletjs.com/-->
      <!--HTML, CSS, & JavaScript materials from: https://www.w3schools.com/default.asp-->
      <!--Collaboration with Professor Baily Hanson, Dr. Shawn Dorius, Dr. Cass Dorius, & Dr. Chris Seeger.-->
      <meta charset="utf-8">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
      <title>Substance Use Treatment and Recovery Providers</title>   
            <!-- Load Leaflet from CDN -->
            <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
                integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
                crossorigin=""/>
            <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
                integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
                crossorigin=""></script>

            <!-- Load Esri Leaflet from CDN -->
            <script src="https://unpkg.com/esri-leaflet@2.4.0/dist/esri-leaflet.js"
                integrity="sha512-kq0i5Xvdq0ii3v+eRLDpa++uaYPlTuFaOYrfQ0Zdjmms/laOwIvLMAxh7cj1eTqqGG47ssAcTY4hjkWydGt6Eg=="
                crossorigin=""></script>
         
            <!--Marker Cluster-->
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
            <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.js"></script>        
            
            <!--Boot Strap-->
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

            <!--J Query-->
            <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
        
            <!--AwesomeMarker-->
            <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.css" rel="stylesheet">
	        <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">
            <link rel="stylesheet" href="PlugIn/awesomemarkers/dist/leaflet.awesome-markers.css" />
            <script src="PlugIn/awesomemarkers/dist/leaflet.awesome-markers.js"></script>

            <!--GeoJSON-->    
            <script src="GeoJSON/USData200503.geojson"></script>
            <script src="GeoJSON/IowaData200503pov.geojson"></script>
            <script src="GeoJSON/IowaData200503.geojson"></script>
            <script src="GeoJSON/IowaData200503copy.geojson"></script>
            <script src="GeoJSON/IowaData200503povcopy.geojson"></script>
            <script src="GeoJSON/MappedIowaSubUseProviders_200723FRData.geojson"></script>
            <script src="GeoJSON/MappedIowaSubUseProviders_200723RData.geojson"></script>
            <script src="GeoJSON/MappedIowaSubUseProviders_200723SRData.geojson"></script>
            <script src="GeoJSON/PeerSupport_200913.geojson"></script>

     
                <style>    
   
            
                     /*map and containers*/
                     #map1container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:430px;padding 0; }
                     #map1 {position: relative; height: 430px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
    
                     #map2container {position:absolute; background-color:#D3D3D3; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:430px;padding 0; }
                     #map2 {position: relative;  height: 430px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
        
                     #map3container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:430px;padding 0; }
                     #map3 {position: relative;  height: 430px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
       
                     #map4container {position:absolute; background-color:#D3D3D3; color:black; text-align:center; margin-right: 0px; margin-left:0px; width:600px; height:430px;padding 0; }
                     #map4 {position: relative;  height: 430px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
       
                     #map5container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:99.9%; height:200px;padding 0; }

                     /*legends*/
                     .legend {
                        line-height: 18px;
                        color: #555;
                        background color:cornsilk
                        }
            
                     .legend i {
                         width: 10px;
                         height: 10px;
                         float: left;
                         margin-right: 8px;
                         opacity: 0.7;
                         }
                
                     .info {
                         padding: 6px 8px;
                         font: 10px/10px Arial, Helvetica, sans-serif;
                         background: white;
                         background: rgba(255,255,255,0.8);
                         box-shadow: 0 0 15px rgba(0,0,0,0.2);
                         border-radius: 5px;
                         }
            
                     .info h4 {
                         margin: 0 0 5px;
                         color: #777;
                         }
            
                     /*Text Formatingg*/
                     h1 {text-align: center}
                     h2 {margin-left: 5px; text-align: center}
                     p  {margin-left: 5px;}
                     h3 {text-align: center}
                     h4 {text-align: center}
                     h5 {text-align: center}
                     h6 {text-align: center}
            
                     /*button styles*/
                     .button1 {
                         background-color: #4CAF50;
                         border: none;
                         color: white;
                         padding: 5px 10px;
                         text-align: center;
                         text-decoration: none;
                         display: inline-block;
                         font-size: 10px;
                         width: 175px;
                         height: 40px;
                         margin: 4px 2px;
                         cursor: pointer;
                         }
                    
                      .button2 {
                         background-color: #5499C7;
                         border: none;
                         color: white;
                         padding: 5px 10px;
                         text-align: center;
                         text-decoration: none;
                         display: inline-block;
                         font-size: 14px;
                         width: 300px;
                         height: 30px;
                         margin: 4px 2px;
                         cursor: pointer;
                         }
                    </style>
            </head>
    <body>  

        <!--Title-->
        <h2>Substance Use and Recovery Providers in Iowa </h2>
      
        <!--Maps and Containers-->
        <div id='map1container'>
            <h2>Substance Use in the United States</h2>
            <p><b>Background:</b> Substance induced mortalities have been increasing over the past 20 years in the United States with an alarming trend related to opioid use and mortalities.  The increase in opioid related mortalities has resulted in the US Department of Health and Human Services declaring a public health emergency (Center for Disease Control, 2020; United States Department of Health and Human Services, 2019).  Nationally, this costs the United States over $740 billion annually in costs associated with the abuse of tobacco, alcohol and illicit drugs (National Institute on Drug Abuse, 2020).</p>  
            <p><b>Map:</b> The map to the right displays the crude mortality rate per 100,000 of substance induced mortalities from 2013-2018.  This data was obtained from the Center for Disease Control WONDER database.  It was uploaded to QGIS and joined to a polygon shapefile of the boundaries of the United States before being exported as a geoJSON file.  </p>
            <p><b>Interactivity:</b> Click on each state to observe the crude substance induced morality rate per 100,000.  As you hover, each state will highlight.  This map is a choropleth map, in which the bright red colors indicates the states with the highest substance induced mortality rates.  Notice how several states with the highest concentration of mortalities range along the Appalachia region of the country.</p>            
        </div>   
 
            <div id="map1"></div>
        
        <div id='map2container'>
            <h2>Substance Use In Iowa </h2>
            <p><b>Background: </b>Rates of alcohol and binge alcohol use are higher in Iowa and residents report lower risk associated with substance use when compared to the rest of the country (Governor’s Office of Drug Control Policy, 2019; Substance Abuse and Mental Health Services Administration, 2018).  Decreased economic resources and increased social isolation related to reductions in family farms has also led to increased alcohol use and mortalities in Iowa (Iowa Department of Public Health State Epidemiological Workgroup, 2016). </p>  
            <p><b>Map: </b>The above map shows Iowa's substance induced mortality crude rate is 21.8 per 100,000.   The map to the right displays the number of substance induced mortalities from 1999-2018 from the Center for Disease Control for Iowa. The map also features Census Bureau 5-year estimates of the percent of each county living below poverty level in the past 12 months.</p>  
            <p><b>Interactivity: </b> Click on each county to observe the number of substance induced deaths.  The counties that are deep purple show the counties that are among the highest in substance induced mortalities. Toggle the menu to see the percent in each county living below poverty.  The counties in dark blue are among the highest percent living below poverty.  Notice how the counties in the lower east corner have both high mortalities and percent living below poverty.</p>
        </div>    
            <div id="map2"></div>

        <div id='map3container'>
            <h2>Substance Use Recovery Providers</h2>
            <p><b>Background:</b> COVID-19 has led to increased social isolation and caused economic vulnerability for many Americans, both of which have been found to be factors related to initial initiation and relapse for those struggling with substance use (Dorius et al, 2020).   This causes great concern that substance induced mortalities will increase in response to COVID-19.<p>
            <p><b>Map:</b> The map on the right displays data from the Advancing Substance Use Recovery in Iowa Project, which is currently in the process of collecting data on agencies providing substance use recovery services. This map displays a preliminary list of Iowa substance use recovery providers in the state.  The cluster layer displays providers focusing on recovery.  The map also displays this information, along with Iowa substance use treatment providers, in single layers on the map.  Daily COVID-19 data is populated into this map via Esri. </p>
            <p><b>Interactivity:</b> Click on the clusters to explore providers focusing on recovery services.  Toggle the layer control to see this information, as well as treatment providers in a single layer.  The layer control also displays Iowa's substance induced mortality data, the percent living below the poverty rate, and the daily number of confirmed COVID-19 cases in each county.  Notice how there is an absence in providers in the southeast, northeast, and northwest corners of the state.  These areas may be targeted in the next phases of data collection to learn if there are providers in these areas. </p>
            </div>
            <div id="map3"></div>
             
         <div id='map4container'>
            <h2>Provider Filters</h2>
             <div class="btn-group">
                 <button type="button" id="ALL" class="button2">All Providers From Scan</button>
		         <br><button type="button" id="SW" class="button1">Southwest Iowa <br>MHDS Region</button>
                 <button type="button" id="SH" class="button1">Southern Hills Regional Mental Health</button>
                 <button type="button" id="SC" class="button1">South Central Behavioral Health Region</button>
                 <br><button type="button" id="SR" class="button1">Sioux Rivers Mental Health and Disabilities Services</button>
                 <button type="button" id="RH" class="button1">Rolling Hills Community Services Region</button>
                 <button type="button" id="PC" class="button1">Polk County <br>Health Services</button>
                 <br><button type="button" id="NW" class="button1">Northwest Iowa <br>Care Connections</button>
                 <button type="button" id="MH" class="button1">Mental Health/Disability Services of the East Central Region</button>
                 <button type="button" id="H" class="button1">Heart of Iowa Community Services Region</button>
                 <br><button type="button" id="EI" class="button1">Eastern Iowa <br>MHDS Region</button>
                 <button type="button" id="CSS" class="button1">County Social <br>Services</button>
                 <button type="button" id="CR" class="button1">County Rural Offices of Social Services</button>
                 <br><button type="button" id="CI" class="button1">Central Iowa Community Services</button>
                 </div>
                 </div>
            <div id="map4"></div>
        
         <div id='map5container'>
            <h5><b>References:</b></h5>
             <h6>Center for Disease Control (2020, March.) <em>Understanding the epidemic.</em> Retreived from: <a href="https://www.cdc.gov/drugoverdose/epidemic/index.html">https://www.cdc.gov/drugoverdose/epidemic/index.html</a>
            <br>Dorius, C., Dorius, S., Rouse, H.L., Richey, E., Talbert, E., Van Selous, K., and Bahe, D. (2020, January). <em>Translating Research into Action: A Multi-method Approach for Informing Substance Use Policy and Practice.</em> Report prepared for the Iowa Department of Public Health.
            <br>Governor’s Office of Drug Control Policy. (2019) <em>Iowa Drug Control Strategy.</em> Retrieved from: <a href="https://odcp.iowa.gov/sites/default/files/documents/2018/11/2019strategyfinal.pdf">https://odcp.iowa.gov/sites/default/files/documents/2018/11/2019strategyfinal.pdf</a>
             <br>Iowa Department of Public Health State Epidemiological Workgroup. (2016). <em>State of Iowa Substance Use Epidemiological Profile 2016.</em> Retrieved from <a href="https://idph.iowa.gov/Portals/1/userfiles/137/2016 Epi Profile.pdf">https://idph.iowa.gov/Portals/1/userfiles/137/2016 Epi Profile.pdf</a>
            <br>National Insitutue on Drug Abuse (2020, February). <em>Trends and Statistics.</em>  Retreived From: <a href="https://www.drugabuse.gov/related-topics/trends-statistics">https://www.drugabuse.gov/related-topics/trends-statistics</a>
            <br>Substance Abuse and Mental Health Services Administration. (2018). <em>2016-2017 National Survey on Drug Use and Health National Maps of Prevalence Estimates, by State.</em> Retrieved from: <a href="https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHsaeMaps2017/NSDUHsaeMaps2017.pdf">https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHsaeMaps2017/NSDUHsaeMaps2017.pdf</a>
            <br>United States Department of Health and Human Services (2019, September 4th).  <em>What is The 	U.S. Opioid Epidemic?</em>  Retrieved from:  <a href="https://www.hhs.gov/opioids/about-the-epidemic/index.html">https://www.hhs.gov/opioids/about-the-epidemic/index.html</a>
            </h6>   
        </div>
       
        <script>
                
            //map 1
            var OSM1 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map1 = L.map('map1', {
                center: [38,-97],
                zoom: 4,
                layers: [OSM1]
		          });
            
            //map 1 styling function    
            function getColorMort(d) {
		          return d  > 40  ? '#FF0000' :
				    d     > 30  ? '#DC143C' :
				    d > 20  ? '#CD5C5C' :
                    d > 10   ? '#F08080' :
				    d > 0   ? '#E9967A' :
                    "#FFFFFF"; 
                    }
            
	        function style1(feature) {
                return {
			     weight: 1,
			     opacity: 1,
			     color: 'white',
			     fillOpacity: 0.7,
			     fillColor: getColorMort(feature.properties.USSubsstanceInducedMort2013_2018_CrudeRate)
		         };
                 }
            
            //map 1 highlighting & pop up functions
            function highlightFeature(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                    layer.bringToFront();
                    }
                    }

            function resetHighlight(e) {
                mort.resetStyle(e.target);
                }

            function onEachFeature(feature, layer) {
                layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight
                });
                if (feature.properties) {
                    layer.bindPopup("<b>State: </b>" + feature.properties.NAME + "<br><b>Substance Induced Crude Death Rate per 100,000: </b>" + feature.properties.USSubsstanceInducedMort2013_2018_CrudeRate);
                    }
                    }
            
            //map 1 data          
            var mort = L.geoJson(mort, {
                style: style1,
                onEachFeature: onEachFeature
                }).addTo(map1);
            
            //map 1 legend
            var legend = L.control({
                position: 'bottomleft'
                });
                legend.onAdd = function(map1) {

            var div = L.DomUtil.create('div', 'info legend'),
                Mort = [0, 10, 20, 30, 40],
                labels = [];
                div.innerHTML += "<b>Substance Induced Mortality Rate </b><br> 2013-2018<br>";
                for (var i = 0; i < Mort.length; i++) {
                    div.innerHTML +=
                    '<i style="background:' + getColorMort(Mort[i] + 1) + '"></i> ' +
                    Mort[i] + (Mort[i + 1] ? '&ndash;' + Mort[i + 1] + '<br>' : '+');
                    }
                return div;
                };
                legend.addTo(map1);

            //map  2   
            var OSM2 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map2 = L.map('map2', {
                center: [42,-93],
                zoom: 7,
                layers: [OSM2]
		          });
            
            //map 2 coloring & style functions 
            function getColor2a(d) {
		      return d  > 200  ? '#4A235A' :
                     d  > 150  ? '#6C3483' :
				     d  > 100  ? '#7D3C98' :
				     d  > 50   ? '#A569BD' :
				     d  >25   ? '#BB8FCE' :
                     d  >10   ? '#E8DAEF' :
                     "#F9EBEA"; 
                     }
             
            function style2a(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor2a(feature.properties.IowaSubstanceInducedDeaths1999_2018_Deaths)
		            };
	               }    
            
            function getColor2b(d) {
		      return d  > 25  ? '#1B4F72' :
                     d  > 20  ? '#2874A6' :
				     d  > 15  ? '#2980B9' :
				     d  > 10   ? '#7FB3D5' :
				     d  >5   ? '#D4E6F1' :
                     d  >0   ? '#EAF2F8' :
                     "#F9EBEA"; 
                     }
             
            function style2b(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor2b(feature.properties.IowaPercentBelowPoverty2013_2018_Percent_BelowPoverty)
		            };
	               }   
            
            //map 2 highlighting & pop up functions
            function highlightFeature2a(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                        layer.bringToFront();
                        }
                        }

            function resetHighlight2a(e) {
                IMort.resetStyle(e.target);
                }

            function onEachFeature2a(feature, layer) {
                layer.on({
                mouseover: highlightFeature2a,
                mouseout: resetHighlight2a
                });
            if (feature.properties) {
                layer.bindPopup("<b>County: </b>" + feature.properties.COUNTY + "<br><b>Number of Substance Induced Deaths: </b>" + feature.properties.IowaSubstanceInducedDeaths1999_2018_Deaths);
                }
                }
            
            function highlightFeature2b(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                        layer.bringToFront();
                        }
                        }
            
            function resetHighlight2b(e) {
                IPov.resetStyle(e.target);
                }
            
            function onEachFeature2b(feature, layer) {
                layer.on({
                mouseover: highlightFeature2b,
                mouseout: resetHighlight2b
                });
            if (feature.properties) {
                layer.bindPopup("<b>County: </b>" + feature.properties.COUNTY + "<br><b>Percent Below Poverty: </b>" + feature.properties.IowaPercentBelowPoverty2013_2018_Percent_BelowPoverty);
                }
                }
            
            //map 2 data          
            var IMort = L.geoJson(IMort, {
                style: style2a,
                onEachFeature: onEachFeature2a
                }).addTo(map2);  
            
            var IPov = L.geoJson(IPov, {
                style: style2b,
                onEachFeature: onEachFeature2b
                })  
            
            //map 2 legends
            var legend2a = L.control({
                position: 'bottomleft'
                });

            legend2a.onAdd = function(map2) {
                var div = L.DomUtil.create('div', 'info legend'),
                IMort = [10, 25, 50, 100, 150, 200],
                labels = [];
                div.innerHTML += "<b>Substance Induced Deaths</b><br>1999-2018<br>";
                for (var i = 0; i < IMort.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2a(IMort[i] + 1) + '"></i> ' +
                        IMort[i] + (IMort[i + 1] ? '&ndash;' + IMort[i + 1] + '<br>' : '+');
                        }
                return div;
                };
                legend2a.addTo(map2);
     
            var legend2b = L.control({
                position: 'bottomleft'
                });

            legend2b.onAdd = function(map2) {
                var div = L.DomUtil.create('div', 'info legend'),
                IPov = [0, 5, 10, 15, 20, 25],
                labels = [];
                div.innerHTML += "<b>Percent Below Poverty</b><br>2013-2018<br>";
                for (var i = 0; i < IPov.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2b(IPov[i] + 1) + '"></i> ' +
                        IPov[i] + (IPov[i + 1] ? '&ndash;' + IPov[i + 1] + '<br>' : '+');
                        }
                return div;
                };
             
  
            //map 2 layer control
		    var baseMap = {
		      "OpenStreetMap": OSM2
                };
       		
		    var overlayMaps = {
		      "Substance Induced Deaths from 1999-2018": IMort,
              "Precent Living Below Poverty Rate": IPov
		      };			

            L.control.layers(baseMap, overlayMaps).addTo(map2);	
            
            //legend filtering
            map2.on('overlayremove', function (eventLayer) {
                console.log(eventLayer.name  + "off");
                if (eventLayer.name == "Substance Induced Deaths from 1999-2018") {
                this.removeControl(legend2a);
                }else if (eventLayer.name == "Precent Living Below Poverty Rate"){
                this.removeControl(legend2b);
	            }
                });

            map2.on('overlayadd', function (eventLayer) {
	          console.log(eventLayer.name + "on");
	           if (eventLayer.name == "Substance Induced Deaths from 1999-2018") {
               legend2a.addTo(this);
               }else if (eventLayer.name == "Precent Living Below Poverty Rate"){
		       legend2b.addTo(this);
               }	
               });
              
               
          //map 3 & 4 pop up function
            function popupProvider(feature, layer) {
                popupOptions = {maxWidth: 200}; 
                    if (feature.properties.Phone == "NA"){ 
                    layer.bindPopup("<b>Program Child: </b>" + feature.properties.ProviderCh +  
                                    "<br><b>Program Name: </b>" + feature.properties.Program +                  
                                    "<br><b>Phone:</b> No Phone available",popupOptions);}
                    else{layer.bindPopup("<b>Program Child: </b>" + feature.properties.ProviderCh + 
                                         "<br><b>Program Name: </b>" + feature.properties.Program +                  
                                         "<br><b>Phone: </b>" +  feature.properties.Phone                 
                    ,popupOptions);   }}
            
            
            //map 3   
            var OSM3 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map3 = L.map('map3', {
                center: [42,-93],
                zoom: 6,
                layers: [OSM3]
		        });
            
            //map 3 provider data, style, and function
            var markers = L.markerClusterGroup();
            
    //        var RData =L.geoJSON(RData, {
      //          style: function (feature) {
        //        return {
          //          stroke: false,
    //                fillColor: 'FFFFFF',
      //              fillOpacity: 0
        //            };
          //          },
            //    onEachFeature: function (feature, layer) {
    //                popupOptions = {maxWidth: 200}; 
      //              if (feature.properties.URL == "NA"){ 
        //            layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
          //                          "<br><b>Link:</b> No URL available",popupOptions);}
            //        else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
    //                                     "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
      //              ,popupOptions);   }
        //            }
          //          })      
    //            markers.addLayer(RData);
      //          map3.addLayer(markers);
             
            
        var PSData =L.geoJSON(PSdata, {
                style: function (feature) {
                return {
                    stroke: false,
                    fillColor: 'FFFFFF',
                    fillOpacity: 0
                    };
                    },
                onEachFeature: popupProvider,
                    })      
                markers.addLayer(PSData);
                map3.addLayer(markers);
            
          
            
            var circle1 = {
                radius: 4,
                fillColor: "#FFA500",
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
                };
                
            var circle2 = {
                radius: 4,
                fillColor: "#46042B", 
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
                };
    
              var PSRData =L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                pointToLayer: function(feature, latlng) {
                    return L.circleMarker(latlng, circle1);
                    },
                    })
              
             function getColor3(d) {
                 return d  > 1000  ? '#873600' :
                        d  > 500  ? '#A04000' :
				        d  > 100  ? '#BA4A00' :
				        d  > 50   ? '#D35400' :
				        d  > 10   ? '#DC7633' :
				        d  > 0   ? '#E59866' :
                        "#E59866"; 
                        }
            
            function style3(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor3(feature.properties.Confirmed)
		            };
	               }   
            //map 3 data
            var COVID =L.esri.featureLayer({     
                url: 'https://services.arcgis.com/vPD5PVLI6sfkZ5E4/ArcGIS/rest/services/IA_COVID19_Cases/FeatureServer/0', style: style3, 
                onEachFeature: function
                (feature, layer) {
                popupOptions = {maxWidth: 200};
                layer.bindPopup("<b>County: </b>" + feature.properties.Name +
                    "<br><b>Confirmed COVID Cases:</b>" + feature.properties.Confirmed
                    ,popupOptions);
                    }
                    }) 
              
            var imort = L.geoJson(imort, {
                style: style2a,
                onEachFeature: onEachFeature2a
                }) 
            
            var ipov = L.geoJson(ipov, {
                style: style2b,
                onEachFeature: onEachFeature2b
                })  

            //map 3 legend
            var legend3a = L.control({
                position: 'bottomleft'
                });

            legend3a.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                COVID = [0, 10, 50, 100, 500, 1000],
                labels = [];
                div.innerHTML += "<b>COVID-19 Cases</b><br>Current Number of Confirmed<br>";
                for (var i = 0; i < COVID.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor3(COVID[i] + 1) + '"></i> ' +
                        COVID[i] + (COVID[i + 1] ? '&ndash;' + COVID[i + 1] + '<br>' : '+');
                        }
                return div;
                };

            var legend3b = L.control({
                position: 'bottomleft'
                });

            legend3b.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                imort = [10, 25, 50, 100, 150, 200],
                labels = [];
                div.innerHTML += "<b>Substance Induced Deaths</b><br>1999-2018<br>";
                for (var i = 0; i < imort.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2a(imort[i] + 1) + '"></i> ' +
                        imort[i] + (imort[i + 1] ? '&ndash;' + imort[i + 1] + '<br>' : '+');
                        }
                return div;
                };
            
            var legend3c = L.control({
                position: 'bottomleft'
                });

            legend3c.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                ipov = [0, 5, 10, 15, 20, 25],
                labels = [];
                div.innerHTML += "<b>Percent Below Poverty</b><br>2013-2018<br>";
                for (var i = 0; i < ipov.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2b(ipov[i] + 1) + '"></i> ' +
                        ipov[i] + (ipov[i + 1] ? '&ndash;' + ipov[i + 1] + '<br>' : '+');
                        }
                return div;
                };
            
            
             var legend3d = L.control({
                position: 'bottomleft'
                });

            legend3d.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                PSRData = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Peer Support Recovery Provider <br>Orange Circles</b>";
                return div;
                };
            
            
            var legend3f = L.control({
                position: 'bottomleft'
                });

            legend3f.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                markers = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Peer Support Recovery Cluster Layer</b><br>";
                return div;
                }
                legend3f.addTo(map3);
            
            
            //map 3 Layer Control
		    var baseMap = {
		      "OpenStreetMap": OSM3
                };
       		
		    var overlayMaps = {
		      "Iowa Substance Use Peer Support Recovery Cluster Layer": markers,
              "Iowa Substance Use Peer Support Recovery Providers": PSRData,
              "Substance Deaths": imort,
              "Percent Poverty": ipov,
              "COVID": COVID
		      };			
         
            L.control.layers(baseMap, overlayMaps).addTo(map3);	
            
             //legend filtering
            map3.on('overlayremove', function (eventLayer) {
                console.log(eventLayer.name  + "off");
                if (eventLayer.name == "COVID") {
                this.removeControl(legend3a);
                }else if (eventLayer.name == "Percent Poverty"){
                this.removeControl(legend3c);
	            }else if (eventLayer.name == "Substance Deaths"){
                this.removeControl(legend3b);
                }else if (eventLayer.name == "Iowa Substance Use Peer Support Recovery Cluster Layer"){
                this.removeControl(legend3f);
                }else if (eventLayer.name == "Iowa Substance Use Peer Support Recovery Providers"){
                this.removeControl(legend3d);
                }
                });

            map3.on('overlayadd', function (eventLayer) {
	          console.log(eventLayer.name + "on");
	           if (eventLayer.name == "COVID") {
               legend3a.addTo(this);
               }else if (eventLayer.name == "Percent Poverty"){
		       legend3c.addTo(this);
               }else if (eventLayer.name == "Substance Deaths"){
		       legend3b.addTo(this);
               }else if (eventLayer.name == "Iowa Substance Use Peer Support Recovery Cluster Layer"){
               legend3f.addTo(this);
               }else if (eventLayer.name == "Iowa Substance Use Peer Support Recovery Providers"){
               legend3d.addTo(this);
               }});
            
            
            //map 4  
            var OSM4 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map4 = L.map('map4', {
                center: [42,-93],
                zoom: 7,
                layers: [OSM4]
		          });
   
            //awesome marker for phone icon 
            var phoneMarker = L.AwesomeMarkers.icon({
                icon: 'phone',
                prefix: 'fa',
                markerColor: 'blue'
                });                      
            
            //map 4 data for buttons 
            var ALL = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                    .addTo(map4);
            
            var SW = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Southwest Iowa MHDS Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
             var SH = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Southern Hills Regional Mental Health') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
      
             var SE = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Southeast Iowa Link') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
               
                var SC = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'South Central Behavioral Health Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
                var SR = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Sioux Rivers Mental Health and Disabilities Services') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                          
                var RH = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Rolling Hills Community Services Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                            
              var PC = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Polk County Health Services') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                                  
              var NW = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Northwest Iowa Care Connections') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                                    
              var MH = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Mental Health\/Disability Services of the East Central Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                                
              var H = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Heart of Iowa Community Services Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })              
                   
              var EI = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Eastern Iowa MHDS Region') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })                         
                  
              var CSS = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'County Social Services') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })           
                
              var CR = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'County Rural Offices of Social Services') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                              
              var CI = L.geoJSON(PSdata, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ProviderPa == 'Central Iowa Community Services') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })     
            
            //Map4 legends    
            var legend4a = L.control({
                position: 'bottomleft'
                });
        
            legend4a.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>All Recovery Providers</b><br>"
                return div;
                };
                legend4a.addTo(map4);
            
             var legend4b = L.control({
                position: 'bottomleft'
                });

            legend4b.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Southwest Iowa MHDS Region</b>";
                return div;
                };
          
             var legend4c = L.control({
                position: 'bottomleft'
                });

            legend4c.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Southern Hills Regional Mental Health</b>";
                return div;
                };
              
             var legend4d = L.control({
                position: 'bottomleft'
                });

            legend4d.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>South Central Behavioral Health Region</b>";
                return div;
                };
      
             var legend4e = L.control({
                position: 'bottomleft'
                });

            legend4e.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Sioux Rivers Mental Health and Disabilities Services</b>";
                return div;
                };
               
             var legend4f = L.control({
                position: 'bottomleft'
                });

            legend4f.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Rolling Hills Community Services Region</b>";
                return div;
                };
    
             var legend4g = L.control({
                position: 'bottomleft'
                });

            legend4g.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Polk County Health Services</b>";
                return div;
                };
            
            var legend4h = L.control({
                position: 'bottomleft'
                });

            legend4h.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Northwest Iowa Care Connections</b>";
                return div;
                };
            
          var legend4i = L.control({
                position: 'bottomleft'
                });

            legend4i.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Mental Health/Disability Services of the East Central Region</b>";
                return div;
                };
            
            var legend4j = L.control({
                position: 'bottomleft'
                });

            legend4j.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Heart of Iowa Community Services Region</b>";
                return div;
                };
            
          var legend4k = L.control({
                position: 'bottomleft'
                });

            legend4k.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Eastern Iowa MHDS Region</b>";
                return div;
                };
            
            var legend4l = L.control({
                position: 'bottomleft'
                });

            legend4l.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>County Social Services</b>";
                return div;
                };
            
       var legend4m = L.control({
                position: 'bottomleft'
                });

            legend4m.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>County Rural Offices of Social Services</b>";
                return div;
                };
            
           var legend4n = L.control({
                position: 'bottomleft'
                });

            legend4n.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                ALL = [],
                labels = [];
                div.innerHTML += "<b>Central Iowa Community Services</b>";
                return div;
                };
                       
            //map 4 filtering
             $("#ALL").click(function() {
                map4.addLayer(ALL);
                map4.addControl(legend4a);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
 
             $("#SW").click(function() {
                map4.addLayer(SW);
                map4.addControl(legend4b);
                map4.removeLayer(ALL);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
            
             $("#SH").click(function() {
                map4.addLayer(SH);
                map4.addControl(legend4c);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
           
             $("#SC").click(function() {
                map4.addLayer(SC);
                map4.addControl(legend4d);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
        
            $("#SR").click(function() {
                map4.addLayer(SR);
                map4.addControl(legend4e);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });            
            
         $("#RH").click(function() {
                map4.addLayer(RH);
                map4.addControl(legend4f);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });  
                
         $("#PC").click(function() {
                map4.addLayer(PC);
                map4.addControl(legend4g);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
            
                           
         $("#NW").click(function() {
                map4.addLayer(NW);
                map4.addControl(legend4h);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });
            
            $("#MH").click(function() {
                map4.addLayer(MH);
                map4.addControl(legend4i);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4j);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });  
                
            $("#H").click(function() {
                map4.addLayer(H);
                map4.addControl(legend4j);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4k);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });  
                  
            $("#EI").click(function() {
                map4.addLayer(EI);
                map4.addControl(legend4k);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });  
                             
            $("#CSS").click(function() {
                map4.addLayer(CSS);
                map4.addControl(legend4l);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CR);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4l);
                map4.removeControl(legend4m);
                map4.removeControl(legend4n);
                });  
            
                                
            $("#CR").click(function() {
                map4.addLayer(CR);
                map4.addControl(legend4m);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CI);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4l);
                map4.removeControl(legend4k);
                map4.removeControl(legend4n);
                });  
            
            $("#CI").click(function() {
                map4.addLayer(CI);
                map4.addControl(legend4n);
                map4.removeLayer(ALL);
                map4.removeLayer(SW);
                map4.removeLayer(SH);
                map4.removeLayer(SC);
                map4.removeLayer(SR);
                map4.removeLayer(RH);
                map4.removeLayer(PC);
                map4.removeLayer(NW);
                map4.removeLayer(MH);
                map4.removeLayer(H);
                map4.removeLayer(EI);
                map4.removeLayer(CSS);
                map4.removeLayer(CR);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                map4.removeControl(legend4i);
                map4.removeControl(legend4j);
                map4.removeControl(legend4l);
                map4.removeControl(legend4k);
                map4.removeControl(legend4m);
                });  
        
           </script>
      </body>
</html>