<!<!DOCTYPE html>
  <html>
    <head>
      <!--Data References-->
      <!--National substance induced mortality rate gejson created by joining 2013-2018 drug/alcohol induced causes of death and United States Tiger/Line Shapefiles from data.gov in QGIS.  Link for CDC: https://wonder.cdc.gov/.  Link for data.gov: https://catalog.data.gov/dataset/tiger-line-shapefile-2017-nation-u-s-current-state-and-equivalent-national--> 
      <!--Iowa substance induced mortality gejson created by joining the number 1999-2018 drug/alcohol induced death and IowaGEOData Shapefiles in QGIS.  Link for CDC: https://wonder.cdc.gov/.  Link for data.gov: https://geodata.iowa.gov/dataset/county-boundaries-iowa--> 
      <!--Iowa poverty geoJSON created by joining the Census Bureausâ€™ 5 year estimates of percent living below poverty in past 12 months and IowaGEOData Shapefiles in QGIS: Link for Census Bureau: https://data.census.gov/cedsci/table?g=0400000US19.050000&tid=ACSST5Y2018.S1701&t=Income%20and%20Poverty&vintage=2018&hidePreview=true&layer=VT_2018_050_00_PY_D1&cid=S1701_C01_001E.  Link for data.gov: https://geodata.iowa.gov/dataset/county-boundaries-iowa-->      <!--Need to add provider data, COVID data, Iowa data etc-->
      <!--Iowa COVID-19 data added as REST layer from Esri from: https://services.arcgis.com/vPD5PVLI6sfkZ5E4/ArcGIS/rest/services/IA_COVID19_Cases/FeatureServer-->
      <!--Iowa Substance Use Provider List added from Advancing Substance Use Recovery Project.  Please see report for more information regarding this dataset.  
        
      <!--Resources to build this page-->
      <!--Course materials from CRP 558.-->
      <!--Example of project final posted to CRP 558: https://rahasan17.github.io/LA458-558/FinalProject/index.html-->
      <!--Leaflet materials from: https://leafletjs.com/-->
      <!--HTML, CSS, & JavaScript materials from: https://www.w3schools.com/default.asp-->
      <!--Collaboration with Professor Baily Hanson, Dr. Shawn Dorius, Dr. Cass Dorius, & Dr. Chris Seeger.-->
      <meta charset="utf-8">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
      <title>Final Project</title>   
            <!-- Load Leaflet from CDN -->
            <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
                integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
                crossorigin=""/>
            <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
                integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
                crossorigin=""></script>

            <!-- Load Esri Leaflet from CDN -->
            <script src="https://unpkg.com/esri-leaflet@2.4.0/dist/esri-leaflet.js"
                integrity="sha512-kq0i5Xvdq0ii3v+eRLDpa++uaYPlTuFaOYrfQ0Zdjmms/laOwIvLMAxh7cj1eTqqGG47ssAcTY4hjkWydGt6Eg=="
                crossorigin=""></script>
         
            <!--Marker Cluster-->
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
            <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
            <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster-src.js"></script>        
            
            <!--Boot Strap-->
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

            <!--J Query-->
            <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
        
            <!--AwesomeMarker-->
            <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.css" rel="stylesheet">
	        <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">
            <link rel="stylesheet" href="PlugIn/awesomemarkers/dist/leaflet.awesome-markers.css" />
            <script src="PlugIn/awesomemarkers/dist/leaflet.awesome-markers.js"></script>

            <!--KVS geoJSON-->    
            <script src="IRP200430.geojson"></script>
            <script src="IRP200430copy.geojson"></script>
            <script src="TXFound200430.geojson"></script>
            <script src="GeoJSON/USData200503.geojson"></script>
            <script src="GeoJSON/IowaData200503pov.geojson"></script>
            <script src="GeoJSON/IowaData200503.geojson"></script>
            <script src="GeoJSON/IowaData200503copy.geojson"></script>
            <script src="GeoJSON/IowaData200503povcopy.geojson"></script>
 
                <style>    
                    /*Drop Down Menu*/
                    ul {
                        list-style-type: none;
                        margin: 0;
                        padding: 0;
                        overflow: hidden;
                        background-color: #333;
                        }

                    li {
                        float: left;
                        }

                    li a, .dropbtn {
                        display: inline-block;
                        color: white;
                        text-align: center;
                        padding: 14px 16px;
                        text-decoration: none;
                        }

                    li a:hover, .dropdown:hover .dropbtn {
                        background-color: red;
                        }

                    li.dropdown {
                        display: inline-block;
                        }

                    .dropdown-content {
                        display: none;
                        position: absolute;
                        background-color: #f9f9f9;
                        min-width: 160px;
                        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
                        z-index: 1;
                        }
                    
                    .dropdown-content a {
                        color: black;
                        padding: 12px 16px;
                        text-decoration: none;
                        display: block;
                        text-align: left;
                        }

                     .dropdown-content a:hover {background-color: #f1f1f1;}

                     .dropdown:hover .dropdown-content {
                        display: block;
                        }
            
                     /*map and containers*/
                     #map1container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:400px;padding 0; }
                     #map1 {position: relative; height: 400px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
    
                     #map2container {position:absolute; background-color:#D3D3D3; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:400px;padding 0; }
                     #map2 {position: relative;  height: 400px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
        
                     #map3container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:600px; height:400px;padding 0; }
                     #map3 {position: relative;  height: 400px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
       
                     #map4container {position:absolute; background-color:#D3D3D3; color:black; text-align:center; margin-right: 0px; margin-left:0px; width:600px; height:400px;padding 0; }
                     #map4 {position: relative;  height: 400px; margin-left:600px;border-left:2px; padding 0; overflow:hidden;}
       
                     #map5container {position:absolute; background-color:#F0F0F0; color:black; text-align:left; margin-right: 0px; margin-left:0px; width:99.9%; height:400px;padding 0; }

                     /*legends*/
                     .legend {
                        line-height: 18px;
                        color: #555;
                        background color:cornsilk
                        }
            
                     .legend i {
                         width: 10px;
                         height: 10px;
                         float: left;
                         margin-right: 8px;
                         opacity: 0.7;
                         }
                
                     .info {
                         padding: 6px 8px;
                         font: 10px/10px Arial, Helvetica, sans-serif;
                         background: white;
                         background: rgba(255,255,255,0.8);
                         box-shadow: 0 0 15px rgba(0,0,0,0.2);
                         border-radius: 5px;
                         }
            
                     .info h4 {
                         margin: 0 0 5px;
                         color: #777;
                         }
            
                     /*Text Formatingg*/
                     h1 {text-align: center}
                     h2 {margin-left: 5px; text-align: center}
                     p  {margin-left: 5px;}
                     h3 {text-align: center}
                     h4 {text-align: center}
            
                     /*button styles*/
                     .button1 {
                         background-color: #4CAF50;
                         border: none;
                         color: white;
                         padding: 5px 10px;
                         text-align: center;
                         text-decoration: none;
                         display: inline-block;
                         font-size: 14px;
                         width: 200px;
                         height: 60px;
                         margin: 4px 2px;
                         cursor: pointer;
                         }
                    
                      .button2 {
                         background-color: #4CAF50;
                         border: none;
                         color: white;
                         padding: 5px 10px;
                         text-align: center;
                         text-decoration: none;
                         display: inline-block;
                         font-size: 14px;
                         width: 300px;
                         height: 30px;
                         margin: 4px 2px;
                         cursor: pointer;
                         }
                    </style>
            </head>
    <body>  
      <!--drop down menu list-->
        <ul>
            <li><a href="https://kvanselous.github.io/CRP558/">Home</a></li>
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">Assignments</a>
            <div class="dropdown-content"> 
                <a href="https://kvanselous.github.io/CRP558/Assignment1/">Assignment 1</a>
                <a href="https://kvanselous.github.io/CRP558/Assignment2/">Assignment 2</a>
                </div>
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">Exercises</a>
                <div class="dropdown-content"> 
                    <a href="https://kvanselous.github.io/CRP558/exercise1/">Exercise 1</a>           
                    <a href="https://kvanselous.github.io/CRP558/exercise2/">Exercise 2</a>
                    <a href="https://kvanselous.github.io/CRP558/exercise3/">Exercise 3</a>
                    <a href="https://kvanselous.github.io/CRP558/exercise4/">Exercise 4</a>
                    <a href="https://kvanselous.github.io/CRP558/exercise5/">Exercise 5</a>   
                    <a href="https://kvanselous.github.io/CRP558/exercise6/">Exercise 6</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise7/">Exercise 7</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise8/">Exercise 8</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise9/">Exercise 9</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise10/">Exercise 10</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise11/">Exercise 11</a>  
                    <a href="https://kvanselous.github.io/CRP558/exercise12/">Exercise 12</a>           
                    </div>        
            <li><a href="https://kvanselous.github.io/CRP558/TechReport/">Tech Report</a></li>
            <li><a href="https://kvanselous.github.io/CRP558/ProjectProposal/">Project Proposal</a></li>
            <li><a href="https://kvanselous.github.io/CRP558/FinalProject/">Final Project</a></li>
            </ul>  
    
        <!--Title-->
        <h2>Preliminary Maps of Substance Use Recovery Providers in Iowa <em>(drafting)</em></h2>
        <h3>CRP 558 Final Project, Spring 2020</h3>
        <h4>Kelsey Van Selous MSW, LCSW
        <br>Human Development and Family Studies PhD Student</h4>
      
        <!--Maps and Containers-->
        <div id='map1container'>
            <h2>Substance Use in the United States</h2>
            <p>Substance induced mortalities have been increasing over the past 20 years in the United States with an alarming trend related to opioid use and mortalities.  The increase in opioid related mortalities has resulted in the US Department of Health and Human Services declaring a public health emergency (Center for Disease Control, 2020; United States Department of Health and Human Services, 2019).  Nationally, this costs the United States over $740 billion annually in costs associated with the abuse of tobacco, alcohol and illicit drugs (National Institute on Drug Abuse, 2020).</p>  
            <p>The map to the right displays the crude mortality rate per 100,000 of substance induced mortalities from 2013-2018.  This data was obtained from the Center for Disease Control WONDER database.  It was uploaded to QGIS and joined to a polygon shapefile of the boundaries of the United States before being exported as a geoJSON file.  </p>
            <p>Hover over each state to observe the crude substance induced morality rate per 100,000.  As you hover, each state will highlight.  This map is a choropleth map, in which the bright red colors indicates the states with the highest substance induced mortality rates.  Notice how several states with the highest concentration of mortalities range along the Appalachia region of the country</p>            
        </div>   
 
            <div id="map1"></div>
        
        <div id='map2container'>
            <h2>Substance Use In Iowa </h2>
            <p>In the above map, youâ€™ll notice that Iowa has a substance induced mortaltity crude rate is 21.8 per 100,000.   The map to the right breaks down this statistic by displaying the number of substance induced mortalties from 1999-2018 from the Center for Disease Control for Iowa counties. </p>  
            <p>This map was also created by uploading the CDC data to QGIS, joining it to a polygon shapefile of Iowa county, and exporting it as a geoJSON file.  Hover over each county to observe the crude substance induced mortality rate per 100,000.  Notice this map includes the same choropleth coloring and groupings as the map above.  The counties that are bright red show the counties that are among the highest in substance induced mortalities.  Notice how they concentrate along the southern border. </p>            
            <p>Toggle the menu on the right to see how high mortality counites align with counties with the highest povery rates.</p>
            </div>    
            <div id="map2"></div>

        <div id='map3container'>
            <h2>Substance Use Recovery Providers</h2>
            <p>Substance use in Iowa is unique as the rate of alcohol and binge alcohol use are higher than the national average and residents report lower risk associated with substance use than compared to the rest of the country (Governorâ€™s Office of Drug Control Policy, 2019; Iowa Department of Public Health, 2018; Substance Abuse and Mental Health Services Administration, 2018 & 2019).  Additionally, decreased economic resources and increased social isolation related to the reductions in family farms has led to increased alcohol consumption and mortalities across the state (Iowa Department of Public Health State Epidemiological Workgroup ,2016) . <p>
            <p>These statistics raise additional alarm, as COVID-19 has led to increased social isolation and caused economic vulnerability for many Americans.  This causes great concern that substance induced mortalities will increase in response to COVID-19 as economic vulnerability and social isolation have been found to be factors related to initial initiation and relapse for those struggling with substance use in the state of Iowa (Dorius et al, 2020).  </p>
	        <p>The map on the right displays data from the Advancing Substance Use Recovery Project, which has been collecting data on agencies providing substance use recovery services in Iowa.  Click on the clusters to explore substance use providers focusing on recovery services.  Toggle the layer control to see this information in a single layer and to see substance use treatment providers.  The layer control also displays Iowa's substance induced mortality data, along with the daily number of confirmed COVID-19 cases in each county.</p>
            </div>
            <div id="map3"></div>
             
         <div id='map4container'>
            <h2>Provider Filters</h2>
            <p>Click on the buttons below to explore options of Iowa Substance Use Recovery Providers:</p>
             <div class="btn-group">
                 <button type="button" id="women" class="button1">Female Only</button>
                 <button type="button" id="men" class="button1">Male Only </button>
                 <br><button type="button" id="family" class="button1">Families</button>
		         <button type="button" id="veteran" class="button1">Veterans</button>
                 <br><button type="button" id="housing" class="button1">Housing </button>
                 <button type="button" id="Religion" class="button1">Religious and Faith Based</button>
                 <br><button type="twelve" id="twelve" class="button1">12-Step Programs</button>
                 <button type="button" id="Out" class="button1">Outpatient Services</button>
                 <br> <button type="button" id="all" class="button2">All Recovery Providers</button>
                 </div>
                 </div>
            <div id="map4"></div>
        
         <div id='map5container'>
            <p>*<em>The tools above have been created for the purposes of this final project and should not be considered an exhausted list of providers or used for purposes beyond this course.  If you are interested in learning more about the Advancing Substance Use Recovery Project in Iowa, please reach out to the project's Principle Investigator Dr. Shawn Dorius.</em></p>
            <br>
            <h4><b>To learn more about the datasets and tools utilzied in this project, please review my <a href="https://kvanselous.github.io/CRP558/FinalProject/Report/index.html">Final Report</a>.</b></h4>
            <br>
            <h4><b>To review the code I used to create this page and meet the criteria for this project please check out my CRP 558 <a href="https://github.com/kvanselous/CRP558/blob/master/FinalProject/index.html">Github repository</a>.</b></h4>
            <h5><b>References:</b></h5>
            Center for Disease Control (2020, March.) <em>Understanding the epidemic</em> Retreived from: https://www.cdc.gov/drugoverdose/epidemic/index.html
            <br>Dorius, C., Dorius, S., Rouse, H.L., Richey, E., Talbert, E., Van Selous, K., and Bahe, D. (2020, January). <em>Translating Research into Action: A Multi-method Approach for Informing Substance Use Policy and Practice.</em> Report prepared for the Iowa Department of Public Health.
            <br>Governorâ€™s Office of Drug Control Policy. (2019) <em>Iowa Drug Control Strategy.</em> Retrieved from https://odcp.iowa.gov/sites/default/files/documents/2018/11/2019strategyfinal.pdf
            <br>Iowa Department of Public Health. (2018). <em>Iowa Substance Abuse Brief Increase in Methamphetamine Use by Iowans.</em> Retrieved from https://idph.iowa.gov/Portals/1/userfiles/133/IASubAbuseBriefNewsletterJune2018_Methamphetamine.pdf  
            <br>Iowa Department of Public Health State Epidemiological Workgroup. (2016). <em>State of Iowa Substance Use Epidemiological Profile 2016.</em> Retrieved from https://idph.iowa.gov/Portals/1/userfiles/137/2016 Epi Profile.pdf
            <br>National Insitutue on Drug Abuse (2020, February). <em>Trends and Statistics</em>Retreived From: https://www.drugabuse.gov/related-topics/trends-statistics
            <br>Substance Abuse and Mental Health Services Administration. (2018). <em>2016-2017 National Survey on Drug Use and Health National Maps of Prevalence Estimates, by State.</em> Retrieved from https://www.samhsa.gov/data/sites/default/files/cbhsq-reports/NSDUHsaeMaps2017/NSDUHsaeMaps2017.pdf
            <br>Substance Abuse and Mental Health Services Administration. (2019). <em>Behavioral Health 	Barometer: Iowa, Volume 5.</em> Retrieved from https://store.samhsa.gov/system/files/pdf-national-bh barometervolume5.pdf
            <br>United States Department of Health and Human Services (2019, September 4th).  <em>What is The 	U.S. Opioid Epidemic?</em>  Retrieved from:  https://www.hhs.gov/opioids/about-the-epidemic/index.html
            </div>
       
        <script>
                
            //map 1
            var OSM1 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map1 = L.map('map1', {
                center: [38,-97],
                zoom: 4,
                layers: [OSM1]
		          });
            
            //map 1 styling function    
            function getColorMort(d) {
		          return d  > 40  ? '#FF0000' :
				    d     > 30  ? '#DC143C' :
				    d > 20  ? '#CD5C5C' :
                    d > 10   ? '#F08080' :
				    d > 0   ? '#E9967A' :
                    "#FFFFFF"; 
                    }
            
	        function style1(feature) {
                return {
			     weight: 1,
			     opacity: 1,
			     color: 'white',
			     fillOpacity: 0.7,
			     fillColor: getColorMort(feature.properties.USSubsstanceInducedMort2013_2018_CrudeRate)
		         };
                 }
            
            //map 1 highlighting & pop up functions
            function highlightFeature(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                    layer.bringToFront();
                    }
                    }

            function resetHighlight(e) {
                mort.resetStyle(e.target);
                }

            function onEachFeature(feature, layer) {
                layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight
                });
                if (feature.properties) {
                    layer.bindPopup("<b>State: </b>" + feature.properties.NAME + "<br><b>Substance Induced Crude Death Rate per 100,000: </b>" + feature.properties.USSubsstanceInducedMort2013_2018_CrudeRate);
                    }
                    }
            
            //map 1 data          
            var mort = L.geoJson(mort, {
                style: style1,
                onEachFeature: onEachFeature
                }).addTo(map1);
            
            //map 1 legend
            var legend = L.control({
                position: 'bottomleft'
                });
                legend.onAdd = function(map1) {

            var div = L.DomUtil.create('div', 'info legend'),
                Mort = [0, 10, 20, 30, 40],
                labels = [];
                div.innerHTML += "<b>Substance Induced Mortality Rate 2013-2018</b><br>";
                for (var i = 0; i < Mort.length; i++) {
                    div.innerHTML +=
                    '<i style="background:' + getColorMort(Mort[i] + 1) + '"></i> ' +
                    Mort[i] + (Mort[i + 1] ? '&ndash;' + Mort[i + 1] + '<br>' : '+');
                    }
                return div;
                };
                legend.addTo(map1);

            //map  2   
            var OSM2 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map2 = L.map('map2', {
                center: [42,-93],
                zoom: 7,
                layers: [OSM2]
		          });
            
            //map 2 coloring & style functions 
            function getColor2a(d) {
		      return d  > 200  ? '#4A235A' :
                     d  > 150  ? '#6C3483' :
				     d  > 100  ? '#7D3C98' :
				     d  > 50   ? '#A569BD' :
				     d  >25   ? '#BB8FCE' :
                     d  >10   ? '#E8DAEF' :
                     "#F9EBEA"; 
                     }
             
            function style2a(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor2a(feature.properties.IowaSubstanceInducedDeaths1999_2018_Deaths)
		            };
	               }    
            
            function getColor2b(d) {
		      return d  > 25  ? '#1B4F72' :
                     d  > 20  ? '#2874A6' :
				     d  > 15  ? '#2980B9' :
				     d  > 10   ? '#7FB3D5' :
				     d  >5   ? '#D4E6F1' :
                     d  >0   ? '#EAF2F8' :
                     "#F9EBEA"; 
                     }
             
            function style2b(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor2b(feature.properties.IowaPercentBelowPoverty2013_2018_Percent_BelowPoverty)
		            };
	               }   
            
            //map 2 highlighting & pop up functions
            function highlightFeature2a(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                        layer.bringToFront();
                        }
                        }

            function resetHighlight2a(e) {
                IMort.resetStyle(e.target);
                }

            function onEachFeature2a(feature, layer) {
                layer.on({
                mouseover: highlightFeature2a,
                mouseout: resetHighlight2a
                });
            if (feature.properties) {
                layer.bindPopup("<b>County: </b>" + feature.properties.COUNTY + "<br><b>Number of Substance Induced Deaths: </b>" + feature.properties.IowaSubstanceInducedDeaths1999_2018_Deaths);
                }
                }
            
            function highlightFeature2b(e) {
                var layer = e.target;
                layer.setStyle({
                    weight: 4,
                    color: 'grey',
                    dashArray: '',
                    fillOpacity: 0.7
                    });
                    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                        layer.bringToFront();
                        }
                        }
            
            function resetHighlight2b(e) {
                IPov.resetStyle(e.target);
                }
            
            function onEachFeature2b(feature, layer) {
                layer.on({
                mouseover: highlightFeature2b,
                mouseout: resetHighlight2b
                });
            if (feature.properties) {
                layer.bindPopup("<b>County: </b>" + feature.properties.COUNTY + "<br><b>Percent Below Poverty: </b>" + feature.properties.IowaPercentBelowPoverty2013_2018_Percent_BelowPoverty);
                }
                }
            
            //map 2 data          
            var IMort = L.geoJson(IMort, {
                style: style2a,
                onEachFeature: onEachFeature2a
                }).addTo(map2);  
            
            var IPov = L.geoJson(IPov, {
                style: style2b,
                onEachFeature: onEachFeature2b
                })  
            
            //map 2 legends
            var legend2a = L.control({
                position: 'bottomleft'
                });

            legend2a.onAdd = function(map2) {
                var div = L.DomUtil.create('div', 'info legend'),
                IMort = [10, 25, 50, 100, 150, 200],
                labels = [];
                div.innerHTML += "<b>Number of Substance Induced Mortality Death's 1999-2018</b><br>";
                for (var i = 0; i < IMort.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2a(IMort[i] + 1) + '"></i> ' +
                        IMort[i] + (IMort[i + 1] ? '&ndash;' + IMort[i + 1] + '<br>' : '+');
                        }
                return div;
                };
                legend2a.addTo(map2);
     
            var legend2b = L.control({
                position: 'bottomleft'
                });

            legend2b.onAdd = function(map2) {
                var div = L.DomUtil.create('div', 'info legend'),
                IPov = [0, 5, 10, 15, 20, 25],
                labels = [];
                div.innerHTML += "<b>Percent Living Below Poverty Level 2013-2018</b><br>";
                for (var i = 0; i < IPov.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2b(IPov[i] + 1) + '"></i> ' +
                        IPov[i] + (IPov[i + 1] ? '&ndash;' + IPov[i + 1] + '<br>' : '+');
                        }
                return div;
                };
             
  
            //map 2 layer control
		    var baseMap = {
		      "OpenStreetMap": OSM2
                };
       		
		    var overlayMaps = {
		      "Substance Induced Deaths from 1999-2018": IMort,
              "Precent Living Below Poverty Rate": IPov
		      };			

            L.control.layers(baseMap, overlayMaps).addTo(map2);	
            
            //legend filtering
            map2.on('overlayremove', function (eventLayer) {
                console.log(eventLayer.name  + "off");
                if (eventLayer.name == "Substance Induced Deaths from 1999-2018") {
                this.removeControl(legend2a);
                }else if (eventLayer.name == "Precent Living Below Poverty Rate"){
                this.removeControl(legend2b);
	            }
                });

            map2.on('overlayadd', function (eventLayer) {
	          console.log(eventLayer.name + "on");
	           if (eventLayer.name == "Substance Induced Deaths from 1999-2018") {
               legend2a.addTo(this);
               }else if (eventLayer.name == "Precent Living Below Poverty Rate"){
		       legend2b.addTo(this);
               }	
               });
              
               
            //map 3   
            var OSM3 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map3 = L.map('map3', {
                center: [42,-93],
                zoom: 6,
                layers: [OSM3]
		        });
            
            //map 3 provider data, style, and function
            var markers = L.markerClusterGroup();
            
            var IRP =L.geoJSON(IRP, {
                style: function (feature) {
                return {
                    stroke: false,
                    fillColor: 'FFFFFF',
                    fillOpacity: 0
                    };
                    },
                onEachFeature: function (feature, layer) {
                    popupOptions = {maxWidth: 200}; 
                    if (feature.properties.URL == "NA"){ 
                    layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
                                    "<br><b>Link:</b> No URL available",popupOptions);}
                    else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
                                         "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
                    ,popupOptions);   }
                    }
                    })      
                markers.addLayer(IRP);
                map3.addLayer(markers);
             
            var circle = {
                radius: 4,
                fillColor: "#ff7800",
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
                };
             
            var SingleIRP =L.geoJSON(SIRP, {
                pointToLayer: function (feature, latlng) {
                return L.circleMarker(latlng, circle);
                },
                onEachFeature: function (feature, layer) {
                    popupOptions = {maxWidth: 200}; 
                    if (feature.properties.URL == "NA"){ 
                    layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
                                    "<br><b>Link:</b> No URL available",popupOptions);}
                    else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
                                         "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
                    ,popupOptions);   }
                    }
                    })
            
             var circle2 = {
                 radius: 4,
                 fillColor: "#green",
                 color: "#000",
                 weight: 1,
                 opacity: 1,
                 fillOpacity: 0.8
                 };
          
             var TX =L.geoJSON(TX, {
                 pointToLayer: function (feature, latlng) {
                 return L.circleMarker(latlng, circle2);
                 },
                 onEachFeature: function (feature, layer) {
                    popupOptions = {maxWidth: 200}; 
                    if (feature.properties.URL == "NA"){ 
                    layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
                                    "<br><b>Link:</b> No URL available",popupOptions);}
                    else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
                                         "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
                    ,popupOptions);   }
                    }
                    })  

             function getColor3(d) {
                 return d  > 1000  ? '#873600' :
                        d  > 500  ? '#A04000' :
				        d  > 100  ? '#BA4A00' :
				        d  > 50   ? '#D35400' :
				        d  > 10   ? '#DC7633' :
				        d  > 0   ? '#E59866' :
                        "#E59866"; 
                        }
            
            function style3(feature) {
                return {
                    weight: 1,
                    opacity: 1,
                    color: 'white',
                    fillOpacity: 0.7,
			        fillColor: getColor3(feature.properties.Confirmed)
		            };
	               }   
            
            //map 3 data
            var COVID =L.esri.featureLayer({     
                url: 'https://services.arcgis.com/vPD5PVLI6sfkZ5E4/ArcGIS/rest/services/IA_COVID19_Cases/FeatureServer/0', style: style3, 
                onEachFeature: function
                (feature, layer) {
                popupOptions = {maxWidth: 200};
                layer.bindPopup("<b>County: </b>" + feature.properties.Name +
                    "<br><b>Confirmed COVID Cases:</b>" + feature.properties.Confirmed
                    ,popupOptions);
                    }
                    }) 
              
            var imort = L.geoJson(imort, {
                style: style2a,
                onEachFeature: onEachFeature2a
                }) 
            
            var ipov = L.geoJson(ipov, {
                style: style2b,
                onEachFeature: onEachFeature2b
                })  

            //map 3 legend
            var legend3a = L.control({
                position: 'bottomleft'
                });

            legend3a.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                COVID = [0, 10, 50, 100, 500, 1000],
                labels = [];
                div.innerHTML += "<b>Current Number of Confirmed COVID-19 Cases</b><br>";
                for (var i = 0; i < COVID.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor3(COVID[i] + 1) + '"></i> ' +
                        COVID[i] + (COVID[i + 1] ? '&ndash;' + COVID[i + 1] + '<br>' : '+');
                        }
                return div;
                };

            var legend3b = L.control({
                position: 'bottomleft'
                });

            legend3b.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                imort = [10, 25, 50, 100, 150, 200],
                labels = [];
                div.innerHTML += "<b>Number of Substance Induced Mortality Death's 1999-2018</b><br>";
                for (var i = 0; i < imort.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2a(imort[i] + 1) + '"></i> ' +
                        imort[i] + (imort[i + 1] ? '&ndash;' + imort[i + 1] + '<br>' : '+');
                        }
                return div;
                };
            
            var legend3c = L.control({
                position: 'bottomleft'
                });

            legend3c.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                ipov = [0, 5, 10, 15, 20, 25],
                labels = [];
                div.innerHTML += "<b>Percent Living Below Poverty Level 2013-2018</b><br>";
                for (var i = 0; i < ipov.length; i++) {
                    div.innerHTML +=
                        '<i style="background:' + getColor2b(ipov[i] + 1) + '"></i> ' +
                        ipov[i] + (ipov[i + 1] ? '&ndash;' + ipov[i + 1] + '<br>' : '+');
                        }
                return div;
                };
            
            var legend3d = L.control({
                position: 'bottomleft'
                });

            legend3d.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                SinglrIRP = [],
                labels = [circle2];
                div.innerHTML += "<b>Iowa Substance Use Treatment Providers-Single Layer (orange circles)</b>"
                return div;
                };
            
             var legend3e = L.control({
                position: 'bottomleft'
                });

            legend3e.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                SinglrIRP = [],
                labels = circle2;
                div.innerHTML += "<b>Iowa Substance Use Treatment Providers-Single Layer (black circles)</b><br>";
                return div;
                };
            
            var legend3f = L.control({
                position: 'bottomleft'
                });

            legend3f.onAdd = function(map3) {
                var div = L.DomUtil.create('div', 'info legend'),
                SinglrIRP = [],
                labels = circle2;
                div.innerHTML += "<b>Iowa Substance Use Treatment Providers-Cluster Layer</b><br>";
                return div;
                };
            legend3f.addTo(map3);
            
            //map 3 Layer Control
		    var baseMap = {
		      "OpenStreetMap": OSM3
                };
       		
		    var overlayMaps = {
		      "Iowa Recovery Providers Cluster Layer": markers,
              "Iowa Recovery Providers Single Layer": SingleIRP, 
              "Iowa Substance Use Treatment Providers Single Layer": TX,
              "Substance Deaths": imort,
              "Percent Poverty": ipov,
              "COVID": COVID
		      };			
         
            L.control.layers(baseMap, overlayMaps).addTo(map3);	
            
             //legend filtering
            map3.on('overlayremove', function (eventLayer) {
                console.log(eventLayer.name  + "off");
                if (eventLayer.name == "COVID") {
                this.removeControl(legend3a);
                }else if (eventLayer.name == "Percent Poverty"){
                this.removeControl(legend3c);
	            }else if (eventLayer.name == "Substance Deaths"){
                this.removeControl(legend3b);
                }else if (eventLayer.name == "Iowa Recovery Providers Single Layer"){
                this.removeControl(legend3d);
                }else if (eventLayer.name == "Iowa Substance Use Treatment Providers Single Layer"){
                this.removeControl(legend3e);
                }else if (eventLayer.name == "Iowa Recovery Providers Cluster Layer"){
                this.removeControl(legend3f);
                }});

            map3.on('overlayadd', function (eventLayer) {
	          console.log(eventLayer.name + "on");
	           if (eventLayer.name == "COVID") {
               legend3a.addTo(this);
               }else if (eventLayer.name == "Percent Poverty"){
		       legend3c.addTo(this);
               }else if (eventLayer.name == "Substance Deaths"){
		       legend3b.addTo(this);
               }else if (eventLayer.name == "Iowa Recovery Providers Single Layer"){
               legend3d.addTo(this);
               }else if (eventLayer.name == "Iowa Substance Use Treatment Providers Single Layer"){
               legend3e.addTo(this);
               }else if (eventLayer.name == "Iowa Recovery Providers Cluster Layer"){
               legend3ef.addTo(this);
               }});
              
            //map 4  
            var OSM4 = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
                });	
            
            var map4 = L.map('map4', {
                center: [42,-93],
                zoom: 7,
                layers: [OSM4]
		          });
   
            //awesome marker for phone icon 
            var phoneMarker = L.AwesomeMarkers.icon({
                icon: 'phone',
                prefix: 'fa',
                markerColor: 'blue'
                });      
             
            //map 4 data that starts on the data 
            var all = L.geoJSON(SIRP, {
                pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                icon: phoneMarker})
                },
                onEachFeature: function (feature, layer) {
                    popupOptions = {maxWidth: 200}; 
                    if (feature.properties.URL == "NA"){ 
                    layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
                                    "<br><b>Phone Number: </b>" + feature.properties.Phone +                  
                                    "<br><b>Link:</b> No URL available",popupOptions);}
                    else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
                                         "<br><b>Phone Number: </b>" + feature.properties.Phone +                  
                                         "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
                    ,popupOptions);   }
                    }}
                    )
                    .addTo(map4);
            
            //map 4 pop up function
            function popupProvider(feature, layer) {
                popupOptions = {maxWidth: 200}; 
                    if (feature.properties.URL == "NA"){ 
                    layer.bindPopup("<b>Site name: </b>" + feature.properties.Name +  
                                    "<br><b>Phone Number: </b>" + feature.properties.Phone +                  
                                    "<br><b>Link:</b> No URL available",popupOptions);}
                    else{layer.bindPopup("<b>Site name: </b>" + feature.properties.Name + 
                                         "<br><b>Phone Number: </b>" + feature.properties.Phone +                  
                                         "<br><b>Link: </b>" + '<a href="'+feature.properties.URL+'">'+feature.properties.URL+'</a>'                   
                    ,popupOptions);   }
                    }
            
            //map 4 data for buttons 
            var housing = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ServiceTyp == 'RecoveryHousing') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
             var twelve = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.twelve_Step == 'Yes') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
            var Out = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.Outpatient == 'Yes') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
            var Religion = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.ReligiousB == 'Yes') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
            var women = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.Gender == 'Women') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
            var men = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.Gender == 'Men') {
                    return true;
                    }
                    },
                pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                
            var family = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.Gender == 'Family') {
                    return true;
                    }
                    },
                 pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
                
            var veteran = L.geoJSON(SIRP, {
                onEachFeature: popupProvider,
                filter: function(feature, layer) {
                    if (feature.properties.Gender == 'Veterans') {
                    return true;
                    }
                    },
                 pointToLayer: function(feature, latlng) {
                    return L.marker(latlng, {icon: phoneMarker});
                    },
                    })
            
            //Map4 legends
                var legend4a = L.control({
                position: 'bottomleft'
                });
        
            legend4a.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br>";
                return div;
                };
                legend4a.addTo(map4);
            
               var legend4b = L.control({
                position: 'bottomleft'
                });

            legend4b.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>With Housing</b>";
                return div;
                };
          
            
             var legend4c = L.control({
                position: 'bottomleft'
                });

            legend4c.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>For Women</b>";
                return div;
                };
       
            
             var legend4d = L.control({
                position: 'bottomleft'
                });

            legend4d.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>For Men</b>";
                return div;
                };
      
            
             var legend4e = L.control({
                position: 'bottomleft'
                });

            legend4e.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>For Families</b>";
                return div;
                };
    
            
             var legend4f = L.control({
                position: 'bottomleft'
                });

            legend4f.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>For Veterans</b>";
                return div;
                };

            
             var legend4g = L.control({
                position: 'bottomleft'
                });

            legend4g.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>With Outpatient Services</b>";
                return div;
                };
            
            var legend4h = L.control({
                position: 'bottomleft'
                });

            legend4h.onAdd = function(map4) {
                var div = L.DomUtil.create('div', 'info legend'),
                all = [],
                labels = [];
                div.innerHTML += "<b>Iowa Substance Use Recovery Providers</b><br><b>With Religious and Faith Based Programming</b>";
                return div;
                };
            
            //map 4 filtering
             $("#all").click(function() {
                map4.addLayer(all);
                map4.addControl(legend4a);
                map4.removeLayer(women);
                map4.removeLayer(men);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });
            
            $("#women").click(function() {
                map4.addLayer(women);
                map4.addControl(legend4c);
                map4.removeLayer(all);
                map4.removeLayer(men);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });

            $("#men").click(function() {
                map4.addLayer(men);
                map4.addControl(legend4d);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });

            $("#family").click(function() {
                map4.addLayer(family);
                map4.addControl(legend4e);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(men);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });
                
            $("#veteran").click(function() {
                map4.addLayer(veteran);
                map4.addControl(legend4f);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(men);
                map4.removeLayer(housing);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });
            
            $("#housing").click(function() {
                map4.addLayer(housing);
                map4.addControl(legend4b);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(men);
                map4.removeLayer(twelve);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });
            
            $("#twelve").click(function() {
                map4.addLayer(twelve);
                map4.addControl(legend4e);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(men);
                map4.removeLayer(Out);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                map4.removeControl(legend4h);
                });
            
            $("#Out").click(function() {
                map4.addLayer(Out);
                map4.addControl(legend4g);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(men);
                map4.removeLayer(twelve);
                map4.removeLayer(Religion);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4h);
                });
            
            $("#Religion").click(function() {
                map4.addLayer(Religion);
                map4.addControl(legend4h);
                map4.removeLayer(all);
                map4.removeLayer(women);
                map4.removeLayer(family);
                map4.removeLayer(veteran);
                map4.removeLayer(housing);
                map4.removeLayer(men);
                map4.removeLayer(Out);
                map4.removeLayer(twelve);
                map4.removeControl(legend4a);
                map4.removeControl(legend4b);
                map4.removeControl(legend4c);
                map4.removeControl(legend4d);
                map4.removeControl(legend4e);
                map4.removeControl(legend4f);
                map4.removeControl(legend4g);
                });

           </script>
      </body>
</html>